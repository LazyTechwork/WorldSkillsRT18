<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Авторизация</title>
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/main.css">
    <style>
        body{
            background: royalblue;
            color: white;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <br><br>
                <h1 class="text-center">SmartHouse</h1>
            </div>
        </div>
        <div class="forAlerts"></div>
        <div class="row">
            <div class="col-sm-12">
                <form action="" id="login-form">
                    <div class="input-group">
                        <input class="form-control" type="text" name="login" placeholder="Логин">
                    </div>
                    <div class="input-group">
                        <input class="form-control" type="password" name="password" placeholder="Пароль">
                    </div><br>
                    <div class="input-group">
                        <input class="form-control" type="submit" value="Войти">
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- === JAVASCRIPT === -->
    <script src="js/jquery.js"></script>
    <script src="js/cookies.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/core.js"></script>
    <script>
        $("#login-form").submit((e) => {
            e.preventDefault();
            location.assign('home.html');
        });
        /*// НЕ РАБОТАЕТ
        // Проверяем на наличие авторизации в COOKIES, если авторизация есть - перенаправлять на страницу управления домом
        if (smartHouseCore.checkAuthorization())
            location.assign('home.html');
        // Отлавливаем событие отправки формы и сами обрабатываем данные
        $("#login-form").submit((e) => {
            // Предотвращение отправки формы обычным способом
            e.preventDefault();
            alert($("#login-form").serialize());
            // Запрос через AJAX
            $.ajax(smartHouseCore.getMethodUrl("login"), {
                method: "POST",
                data: $("#login-form").serialize(),
                success: (data) => {
                    // Парсим JSON данные
                    let prettyData = $.parseJSON(data);
                    // Если есть ошибки - выводим соответствующее сообщение, если нет - авторизуем пользователя в системе и переходим к странице управления домом
                    if (!smartHouseCore.isKeyEmpty(pretty.errors))
                        $(".forAlerts").html('<div class="row"><div class="col-sm-12"><div class="alert alert-danger">' + pretty.errors + '</div></div>');
                    else {
                        smartHouseCore.authorize(pretty.token);
                        location.assign('home.html');
                    }
                }
            });
        });*/

    </script>
</body>

</html>
